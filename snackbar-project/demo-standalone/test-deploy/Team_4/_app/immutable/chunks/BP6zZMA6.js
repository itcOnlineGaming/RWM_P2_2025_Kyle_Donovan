import{aT as w,k as c,aP as _,aU as h,t as S,aV as y,aW as N,Y as W,aX as $,h as q,X as E,at as I}from"./C5Mxa1Nn.js";import{s as g}from"./CdwLM3Zx.js";function k(e,i,t=!1){if(e.multiple){if(i==null)return;if(!S(i))return y();for(var r of e.options)r.selected=i.includes(u(r));return}for(r of e.options){var n=u(r);if(N(n,i)){r.selected=!0;return}}(!t||i!==void 0)&&(e.selectedIndex=-1)}function T(e){var i=new MutationObserver(()=>{k(e,e.__value)});i.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),W(()=>{i.disconnect()})}function L(e,i,t=i){var r=new WeakSet,n=!0;w(e,"change",a=>{var s=a?"[selected]":":checked",o;if(e.multiple)o=[].map.call(e.querySelectorAll(s),u);else{var l=e.querySelector(s)??e.querySelector("option:not([disabled])");o=l&&u(l)}t(o),c!==null&&r.add(c)}),_(()=>{var a=i();if(e===document.activeElement){var s=h??c;if(r.has(s))return}if(k(e,a,n),n&&a===void 0){var o=e.querySelector(":checked");o!==null&&(a=u(o),t(a))}e.__value=a,n=!1}),T(e)}function u(e){return"__value"in e?e.__value:e.value}function R(e,i,t=i){var r=new WeakSet;w(e,"input",async n=>{var a=n?e.defaultValue:e.value;if(a=d(e)?v(a):a,t(a),c!==null&&r.add(c),await $(),a!==(a=i())){var s=e.selectionStart,o=e.selectionEnd,l=e.value.length;if(e.value=a??"",o!==null){var f=e.value.length;s===o&&o===l&&f>l?(e.selectionStart=f,e.selectionEnd=f):(e.selectionStart=s,e.selectionEnd=Math.min(o,f))}}}),(q&&e.defaultValue!==e.value||E(i)==null&&e.value)&&(t(d(e)?v(e.value):e.value),c!==null&&r.add(c)),I(()=>{var n=i();if(e===document.activeElement){var a=h??c;if(r.has(a))return}d(e)&&n===v(e.value)||e.type==="date"&&!n&&!e.value||n!==e.value&&(e.value=n??"")})}function d(e){var i=e.type;return i==="number"||i==="range"}function v(e){return e===""?null:+e}async function D(){if(!("serviceWorker"in navigator))return console.warn("Service Workers not supported"),null;try{const e=document.querySelector("base")?.getAttribute("href")||"/",i=`${e}sw.js`.replace("//","/"),t=await navigator.serviceWorker.register(i,{scope:e});return console.log("Service Worker registered:",t),t}catch(e){return console.error("Service Worker registration failed:",e),null}}async function U(){const e=await D();let i="default";return"Notification"in window&&(Notification.permission==="granted"?i="granted":Notification.permission!=="denied"?i=await Notification.requestPermission():i="denied"),{permission:i,registration:e}}async function M(e,i,t){if(!navigator.serviceWorker.controller){if(console.warn("Service Worker not controlling the page yet"),Notification.permission==="granted"){const r={body:i,icon:t?.icon||"ğŸ“…",badge:t?.badge||"ğŸ“…",tag:t?.tag||"notification",vibrate:t?.vibrate||[200,100,200],requireInteraction:t?.requireInteraction||!1,silent:t?.silent||!1};new Notification(e,r)}return}try{const r=await navigator.serviceWorker.ready,n={body:i,icon:t?.icon||"ğŸ“…",badge:t?.badge||"ğŸ“…",tag:t?.tag||"notification",vibrate:t?.vibrate||[200,100,200],requireInteraction:t?.requireInteraction||!1,silent:t?.silent||!1,data:{dateTime:new Date().toISOString(),url:"/"}};await r.showNotification(e,n),console.log("Mobile notification sent via Service Worker")}catch(r){console.error("Failed to show notification:",r)}}async function m(e,i,t){if(!("Notification"in window))return console.warn("This browser does not support notifications"),null;if(Notification.permission!=="granted")return console.warn("Notification permission not granted"),null;if("serviceWorker"in navigator&&navigator.serviceWorker.controller)return await M(e,i,t),null;const r={body:i,icon:t?.icon||"ğŸ“…",badge:t?.badge||"ğŸ“…",tag:t?.tag||"calendar-notification",requireInteraction:t?.requireInteraction||!1,silent:t?.silent||!1};return t?.vibrate&&"vibrate"in navigator&&(r.vibrate=t.vibrate),new Notification(e,r)}function b(){return"Notification"in window&&Notification.permission==="granted"}function V(e,i){const t=e.date.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});g.success(`Event created: ${e.title} on ${t}`,{position:i?.snackbarPosition||"bottom-right",duration:i?.snackbarDuration||4e3}),i?.showDesktopNotification!==!1&&b()&&m("Event Created",`${e.title} scheduled for ${t}`,{icon:P(e.type),tag:`event-created-${e.date.getTime()}`})}function x(e,i){g.error(`Event cancelled: ${e.title}`,{position:i?.snackbarPosition||"bottom-right",duration:5e3}),i?.showDesktopNotification!==!1&&b()&&m("Event Cancelled",`${e.title} has been cancelled`,{icon:"âŒ",tag:`event-cancelled-${e.date.getTime()}`,vibrate:[200,100,200,100,200]})}function A(e,i,t){const r=e.date.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"});g.warning(`Reminder: ${e.title} starts in ${i} minutes`,{position:t?.snackbarPosition||"top-right",duration:6e3}),t?.showDesktopNotification!==!1&&b()&&m("Meeting Reminder",`${e.title} starts at ${r} (in ${i} minutes)`,{icon:"â°",tag:`event-reminder-${e.date.getTime()}`,requireInteraction:!0,vibrate:[300,100,300]})}function P(e){switch(e){case"meeting":return"ğŸ“";case"call":return"ğŸ“";case"review":return"ğŸ‘ï¸";case"demo":return"ğŸ¯";case"reminder":return"â°";default:return"ğŸ“…"}}export{L as a,R as b,x as c,A as d,V as n,U as s};
